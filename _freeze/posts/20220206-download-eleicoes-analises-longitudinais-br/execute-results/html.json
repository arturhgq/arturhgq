{
  "hash": "ff2fc5f0ace43d2d6f357f622bb6c270",
  "result": {
    "markdown": "---\ntitle: \"Download de dados eleitorais para análises longitudinais usando R\"\ndate: \"2023-02-05\"\ndate-modified: \"2023-02-19\"\nauthor: \"Artur Quirino\"\nexecute: \n  eval: FALSE\ncategories:\n  - elections\n  - R\n---\n\n\nO [Tribunal Superior Eleitoral](https://www.tse.jus.br/) (TSE) disponibiliza para download um vasto conjunto \nde microdados eleitorais  em seu [Portal de Dados Abertos](https://dadosabertos.tse.jus.br/). Nesta breve postagem, \neu crio uma função exemplo para gerar as *urls* que armazenam as tabelas \ncontidas no portal. A função é útil em análises longitudinais. \n\nNote que `make_urls` monta os endereços para tabelas de eleitorado, de detalhes da votação\npor seção eleitoral e de votação nominal por município e zona. Para montar outras *urls*, \ncomo as dos boletins de urna, `make_urls` terá que ser ajustada para lidar \ncom o padrão das *urls* dos boletins, que é distinto. Outras *urls*, como as de votação \nnominal por seção eleitoral, seguem o mesmo padrão e podem ser incorporadas a \nlista de elementos presente no código abaixo.\n\n## Monta as *urls*\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Função para gerar os links\nmake_urls = function(x) {\n  urls = lapply(x, function(x) {\n    y = list(\n      eleitorado = paste0(\"https://cdn.tse.jus.br/estatistica/sead/odsele/perfil_eleitorado/perfil_eleitorado_\", x, \".zip\"),\n      votacao_detalhes = paste0(\"https://cdn.tse.jus.br/estatistica/sead/odsele/detalhe_votacao_secao/detalhe_votacao_secao_\", x, \".zip\"),\n      votacao_nominal_zona = paste0(\"https://cdn.tse.jus.br/estatistica/sead/odsele/votacao_candidato_munzona/votacao_candidato_munzona_\", x, \".zip\")\n      ## para o download de outras tabelas, repita a estrutura acima. \n      ## \"rótulo = paste(\"início da url\", ano, \"final da url\")\"\n    )\n    setNames(y, paste0(names(y), x))\n  })\n  unlist(urls, recursive = FALSE)\n} \n\n## Cria os links\nyear = seq(1994, 2022, by = 4)\n\nurls = make_urls(year)\nurls\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$eleitorado1994\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/perfil_eleitorado/perfil_eleitorado_1994.zip\"\n\n$votacao_detalhes1994\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/detalhe_votacao_secao/detalhe_votacao_secao_1994.zip\"\n\n$votacao_nominal_zona1994\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/votacao_candidato_munzona/votacao_candidato_munzona_1994.zip\"\n\n$eleitorado1998\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/perfil_eleitorado/perfil_eleitorado_1998.zip\"\n\n$votacao_detalhes1998\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/detalhe_votacao_secao/detalhe_votacao_secao_1998.zip\"\n\n$votacao_nominal_zona1998\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/votacao_candidato_munzona/votacao_candidato_munzona_1998.zip\"\n\n$eleitorado2002\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/perfil_eleitorado/perfil_eleitorado_2002.zip\"\n\n$votacao_detalhes2002\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/detalhe_votacao_secao/detalhe_votacao_secao_2002.zip\"\n\n$votacao_nominal_zona2002\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/votacao_candidato_munzona/votacao_candidato_munzona_2002.zip\"\n\n$eleitorado2006\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/perfil_eleitorado/perfil_eleitorado_2006.zip\"\n\n$votacao_detalhes2006\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/detalhe_votacao_secao/detalhe_votacao_secao_2006.zip\"\n\n$votacao_nominal_zona2006\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/votacao_candidato_munzona/votacao_candidato_munzona_2006.zip\"\n\n$eleitorado2010\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/perfil_eleitorado/perfil_eleitorado_2010.zip\"\n\n$votacao_detalhes2010\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/detalhe_votacao_secao/detalhe_votacao_secao_2010.zip\"\n\n$votacao_nominal_zona2010\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/votacao_candidato_munzona/votacao_candidato_munzona_2010.zip\"\n\n$eleitorado2014\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/perfil_eleitorado/perfil_eleitorado_2014.zip\"\n\n$votacao_detalhes2014\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/detalhe_votacao_secao/detalhe_votacao_secao_2014.zip\"\n\n$votacao_nominal_zona2014\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/votacao_candidato_munzona/votacao_candidato_munzona_2014.zip\"\n\n$eleitorado2018\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/perfil_eleitorado/perfil_eleitorado_2018.zip\"\n\n$votacao_detalhes2018\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/detalhe_votacao_secao/detalhe_votacao_secao_2018.zip\"\n\n$votacao_nominal_zona2018\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/votacao_candidato_munzona/votacao_candidato_munzona_2018.zip\"\n\n$eleitorado2022\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/perfil_eleitorado/perfil_eleitorado_2022.zip\"\n\n$votacao_detalhes2022\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/detalhe_votacao_secao/detalhe_votacao_secao_2022.zip\"\n\n$votacao_nominal_zona2022\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/votacao_candidato_munzona/votacao_candidato_munzona_2022.zip\"\n```\n:::\n:::\n\n\n## Download das tabelas\n\n\n::: {.cell}\n\n```{.r .cell-code}\nremotes::install_github(\"arturhgq/dtools\")\nfiles = dtools::download.files(urls)\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}