[
  {
    "objectID": "posts/regimes/regimes.html",
    "href": "posts/regimes/regimes.html",
    "title": "Regimes",
    "section": "",
    "text": "No matching items"
  },
  {
    "objectID": "posts/benchmarking/benchmarking.html",
    "href": "posts/benchmarking/benchmarking.html",
    "title": "Tools for data analysis: benchmarking",
    "section": "",
    "text": "No matching items"
  },
  {
    "objectID": "posts/R/20230208-reading-microsoft365-r.html",
    "href": "posts/R/20230208-reading-microsoft365-r.html",
    "title": "Reading OneDrive and SharePoint files with read365 R package",
    "section": "",
    "text": "In this post, I would like to introduce four functions available in the read365 R package that allow for the reading of OneDrive and SharePoint files: OneDrive_file, SharePoint_file, OneDrive_shared_file and SharePoint_shared_file. The former two functions are intended for private content, while the last two are designed for public files. It is worth noting that read365 is heavily reliant on the Microsoft365R package.\nThe goal of the read365 package is to allow users to read files from Office365 directly in R, without the need to sync files between their computer and the cloud."
  },
  {
    "objectID": "posts/R/20230208-reading-microsoft365-r.html#reading-private-content-from-onedrive",
    "href": "posts/R/20230208-reading-microsoft365-r.html#reading-private-content-from-onedrive",
    "title": "Reading OneDrive and SharePoint files with read365 R package",
    "section": "Reading private content from OneDrive",
    "text": "Reading private content from OneDrive\nThe OneDrive_file function executes the login process onto OneDrive by utilizing Azure Active Directory authentication. Upon successful authentication, OneDrive_file requires users to set three parameters: the location of the file (file), the desired function for reading the file (.function), and optionally, arguments for this function (...). See the example below.\n\n#remotes::install_github(\"arturhgq/read365\")\nread365::OneDrive_file(\n  \"CienciaPolitica/data/read365_examples/OneDrive_file.xlsx\",\n  readxl::read_excel, \n  sheet = 1\n)\n\nLoading Microsoft Graph login for default tenant\n\n\n# A tibble: 3 × 3\n   col1  col2 `private content`\n  <dbl> <dbl> <chr>            \n1     1     2 TRUE             \n2     3     4 TRUE             \n3     5     6 TRUE"
  },
  {
    "objectID": "posts/R/20230208-reading-microsoft365-r.html#reading-private-content-from-sharepoint",
    "href": "posts/R/20230208-reading-microsoft365-r.html#reading-private-content-from-sharepoint",
    "title": "Reading OneDrive and SharePoint files with read365 R package",
    "section": "Reading private content from SharePoint",
    "text": "Reading private content from SharePoint\nShortly, the usage of the SharePoint_file is similiar to OneDrive_file. However, there are two additional parameters that must be set: SharePoint and drive. In the SharePoint parameter, the user is required to specify the SharePoint URL where the target file is located. As SharePoint may contain multiple drives to store files, users must indicate the specific drive1 to be accessed too. In most cases, “Documents” is the primary drive for storing files in SharePoint.\n\nread365::SharePoint_file(\n  SharePoint = \"https://arturhgq.sharepoint.com\",\n  drive = \"Documentos\",\n  file = \"Sharepoint_file.xlsx\",\n  .function = readxl::read_excel\n)\n\nLoading Microsoft Graph login for default tenant\n\n\n# A tibble: 3 × 4\n   col1  col2 `private content` SharePoint\n  <dbl> <dbl> <chr>             <chr>     \n1     1     2 TRUE              TRUE      \n2     3     4 TRUE              TRUE      \n3     5     6 TRUE              TRUE"
  },
  {
    "objectID": "posts/R/20230208-reading-microsoft365-r.html#reading-public-content-from-onedrive-or-sharepoint",
    "href": "posts/R/20230208-reading-microsoft365-r.html#reading-public-content-from-onedrive-or-sharepoint",
    "title": "Reading OneDrive and SharePoint files with read365 R package",
    "section": "Reading public content from OneDrive or SharePoint",
    "text": "Reading public content from OneDrive or SharePoint\nTo use OneDrive_shared_file or SharePoint_shared_file2 no authentication is required. Therefore, all that is needed is to provide the file’s URL along with the corresponding function for reading the file and, optionally, its respective parameters.\n\n url_OneDrive = 'https://arturhgq-my.sharepoint.com/:x:/p/contact/EZ_KJ3cqtIVEh4PdXhTGy7IBpWT5_Zlp2VjYwlgVCPK4oQ?e=UZGQZt'\n url_SharePoint = 'https://arturhgq.sharepoint.com/:x:/g/EZOMb55WRsZFhXuo5K8uGXYBaRdGPNhX7lFNDjLpphj-mw?e=nCm0L4'\n \n read365::OneDrive_shared_file(\n    url_OneDrive,\n    .function = readxl::read_excel,\n    sheet = 1\n  )\n\n# A tibble: 3 × 2\n   col1  col2\n  <dbl> <dbl>\n1     1     2\n2     3     4\n3     5     6\n\n  read365::SharePoint_shared_file(\n    url_SharePoint,\n    .function = readxl::read_excel,\n    sheet = 1\n  )\n\n# A tibble: 3 × 4\n   col1  col2 `private content` SharePoint\n  <dbl> <dbl> <chr>             <chr>     \n1     1     2 TRUE              TRUE      \n2     3     4 TRUE              TRUE      \n3     5     6 TRUE              TRUE"
  },
  {
    "objectID": "posts/R/R.html",
    "href": "posts/R/R.html",
    "title": "R",
    "section": "",
    "text": "Order By\n       Default\n         \n          Date - Oldest\n        \n         \n          Date - Newest\n        \n         \n          Title\n        \n         \n          Author\n        \n     \n  \n    \n      \n      \n    \n\n\n\n\n\n\nDate\n\n\nTitle\n\n\nAuthor\n\n\n\n\n\n\nFeb 8, 2023\n\n\nReading OneDrive and SharePoint files with read365 R package\n\n\nArtur Quirino\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/python/python.html",
    "href": "posts/python/python.html",
    "title": "Python",
    "section": "",
    "text": "No matching items"
  },
  {
    "objectID": "posts/programming/programming.html",
    "href": "posts/programming/programming.html",
    "title": "Programming",
    "section": "",
    "text": "No matching items"
  },
  {
    "objectID": "posts/parties/parties.html",
    "href": "posts/parties/parties.html",
    "title": "Political Parties",
    "section": "",
    "text": "No matching items"
  },
  {
    "objectID": "posts/accountability/accountability.html",
    "href": "posts/accountability/accountability.html",
    "title": "Accountability",
    "section": "",
    "text": "No matching items"
  },
  {
    "objectID": "posts/elections/20220206-download-eleicoes-analises-longitudinais-br.html",
    "href": "posts/elections/20220206-download-eleicoes-analises-longitudinais-br.html",
    "title": "Download de dados eleitorais para análises longitudinais usando R",
    "section": "",
    "text": "O Tribunal Superior Eleitoral (TSE) disponibiliza para download um vasto conjunto de microdados eleitorais em seu Portal de Dados Abertos. Nesta breve postagem, eu crio uma função exemplo para gerar as urls que armazenam as tabelas contidas no portal. A função é útil em análises longitudinais.\nNote que make_urls monta os endereços para tabelas de eleitorado, de detalhes da votação por seção eleitoral e de votação nominal por município e zona. Para montar outras urls, como as dos boletins de urna, make_urls terá que ser ajustada para lidar com o padrão das urls dos boletins, que é distinto. Outras urls, como as de votação nominal por seção eleitoral, seguem o mesmo padrão e podem ser incorporadas a lista de elementos presente no código abaixo."
  },
  {
    "objectID": "posts/elections/20220206-download-eleicoes-analises-longitudinais-br.html#monta-as-urls",
    "href": "posts/elections/20220206-download-eleicoes-analises-longitudinais-br.html#monta-as-urls",
    "title": "Download de dados eleitorais para análises longitudinais usando R",
    "section": "Monta as urls",
    "text": "Monta as urls\n\n## Função para gerar os links\nmake_urls = function(x) {\n  urls = lapply(x, function(x) {\n    y = list(\n      eleitorado = paste0(\"https://cdn.tse.jus.br/estatistica/sead/odsele/perfil_eleitorado/perfil_eleitorado_\", x, \".zip\"),\n      votacao_detalhes = paste0(\"https://cdn.tse.jus.br/estatistica/sead/odsele/detalhe_votacao_secao/detalhe_votacao_secao_\", x, \".zip\"),\n      votacao_nominal_zona = paste0(\"https://cdn.tse.jus.br/estatistica/sead/odsele/votacao_candidato_munzona/votacao_candidato_munzona_\", x, \".zip\")\n      ## para o download de outras tabelas, repita a estrutura acima. \n      ## \"rótulo = paste(\"início da url\", ano, \"final da url\")\"\n    )\n    setNames(y, paste0(names(y), x))\n  })\n  unlist(urls, recursive = FALSE)\n} \n\n## Cria os links\nyear = seq(1994, 2022, by = 4)\n\nurls = make_urls(year)\nurls\n\n$eleitorado1994\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/perfil_eleitorado/perfil_eleitorado_1994.zip\"\n\n$votacao_detalhes1994\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/detalhe_votacao_secao/detalhe_votacao_secao_1994.zip\"\n\n$votacao_nominal_zona1994\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/votacao_candidato_munzona/votacao_candidato_munzona_1994.zip\"\n\n$eleitorado1998\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/perfil_eleitorado/perfil_eleitorado_1998.zip\"\n\n$votacao_detalhes1998\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/detalhe_votacao_secao/detalhe_votacao_secao_1998.zip\"\n\n$votacao_nominal_zona1998\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/votacao_candidato_munzona/votacao_candidato_munzona_1998.zip\"\n\n$eleitorado2002\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/perfil_eleitorado/perfil_eleitorado_2002.zip\"\n\n$votacao_detalhes2002\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/detalhe_votacao_secao/detalhe_votacao_secao_2002.zip\"\n\n$votacao_nominal_zona2002\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/votacao_candidato_munzona/votacao_candidato_munzona_2002.zip\"\n\n$eleitorado2006\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/perfil_eleitorado/perfil_eleitorado_2006.zip\"\n\n$votacao_detalhes2006\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/detalhe_votacao_secao/detalhe_votacao_secao_2006.zip\"\n\n$votacao_nominal_zona2006\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/votacao_candidato_munzona/votacao_candidato_munzona_2006.zip\"\n\n$eleitorado2010\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/perfil_eleitorado/perfil_eleitorado_2010.zip\"\n\n$votacao_detalhes2010\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/detalhe_votacao_secao/detalhe_votacao_secao_2010.zip\"\n\n$votacao_nominal_zona2010\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/votacao_candidato_munzona/votacao_candidato_munzona_2010.zip\"\n\n$eleitorado2014\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/perfil_eleitorado/perfil_eleitorado_2014.zip\"\n\n$votacao_detalhes2014\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/detalhe_votacao_secao/detalhe_votacao_secao_2014.zip\"\n\n$votacao_nominal_zona2014\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/votacao_candidato_munzona/votacao_candidato_munzona_2014.zip\"\n\n$eleitorado2018\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/perfil_eleitorado/perfil_eleitorado_2018.zip\"\n\n$votacao_detalhes2018\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/detalhe_votacao_secao/detalhe_votacao_secao_2018.zip\"\n\n$votacao_nominal_zona2018\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/votacao_candidato_munzona/votacao_candidato_munzona_2018.zip\"\n\n$eleitorado2022\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/perfil_eleitorado/perfil_eleitorado_2022.zip\"\n\n$votacao_detalhes2022\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/detalhe_votacao_secao/detalhe_votacao_secao_2022.zip\"\n\n$votacao_nominal_zona2022\n[1] \"https://cdn.tse.jus.br/estatistica/sead/odsele/votacao_candidato_munzona/votacao_candidato_munzona_2022.zip\""
  },
  {
    "objectID": "posts/elections/20220206-download-eleicoes-analises-longitudinais-br.html#download-das-tabelas",
    "href": "posts/elections/20220206-download-eleicoes-analises-longitudinais-br.html#download-das-tabelas",
    "title": "Download de dados eleitorais para análises longitudinais usando R",
    "section": "Download das tabelas",
    "text": "Download das tabelas\n\nremotes::install_github(\"arturhgq/dtools\")\nfiles = dtools::download.files(urls)"
  },
  {
    "objectID": "posts/elections/elections.html",
    "href": "posts/elections/elections.html",
    "title": "Elections",
    "section": "",
    "text": "Order By\n       Default\n         \n          Date - Oldest\n        \n         \n          Date - Newest\n        \n         \n          Title\n        \n         \n          Author\n        \n     \n  \n    \n      \n      \n    \n\n\n\n\n\n\nDate\n\n\nTitle\n\n\nAuthor\n\n\n\n\n\n\nOct 9, 2022\n\n\nQuem não votou nas eleições brasileiras de 2022?\n\n\nArtur Quirino\n\n\n\n\nFeb 5, 2023\n\n\nDownload de dados eleitorais para análises longitudinais usando R\n\n\nArtur Quirino\n\n\n\n\nFeb 6, 2023\n\n\nDownload e tratamento de dados das eleições brasileiras usando R\n\n\nArtur Quirino\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/elections/20221009-perfil-abstencao-eleicoes-br-2022.html",
    "href": "posts/elections/20221009-perfil-abstencao-eleicoes-br-2022.html",
    "title": "Quem não votou nas eleições brasileiras de 2022?",
    "section": "",
    "text": "Quem não votou nas eleições brasileiras de 2022? Recentemente, pesquisadores eleitorais, políticos e jornalistas repercutiram divergências entre pesquisas eleitorais e resultados das urnas. Especialistas, de um lado, afirmaram que a discrepância entre intenção de voto e votos válidos reside na dificuldade de estimação das taxas de abstenção em pesquisas eleitorais. Sem adequadas taxas de abstenção, argumentam, pesquisas de intenção de voto não devem ser lidas como preditores de votos válidos1. De outro lado, institutos de pesquisas reuniram esforços para produzir ferramentas capazes de estimar quem seriam os eleitores prováveis, que compareceriam no segundo turno das eleições presidenciais de 2022.\nNesta postagem, eu extraio a taxa de abstenção nas eleições de 2022 para cada região geográfica brasileira. Os dados estão desagregados pelo perfil sociodemográfico dos eleitores aptos a votar.\n\n\nCode\n# Leitura e manipulação dos dados\n## Leitura dos dados \n\neleitorado_mun2022 = \"https://arturhgq-my.sharepoint.com/:x:/p/contact/EWAJSj5LIPxFhnVZ1Dnm6XsBjM4UKkzzvZcdmknX_rz5Xw?e=fkf8Ke\"\n\ndata = read365::OneDrive_shared_file(\n  eleitorado_mun2022,\n  .function = vroom::vroom,\n  show_col_types = FALSE\n) \n\n# data.table\ndata.table::setDT(data)\n\n## Operações com os dados\n### Remodela a tabela do eleitorado\ndt_melt = data.table::melt(\n  data, \n  measure.vars = c(\"DS_GRAU_ESCOLARIDADE\", \"DS_GENERO\", \"DS_FAIXA_ETARIA\"),\n  variable.name = \"PERFIL_VARS\",\n  value.name = \"PERFIL_VALUE\"\n) \n\n### Recodifica as categorias da variável 'PERFIL_VALUE'\nrecode_perfil = function(x) {\n  data.table::fcase(\n    x == \"ENSINO FUNDAMENTAL COMPLETO\", \"Ensino Fundamental\", \n    x == \"ENSINO FUNDAMENTAL INCOMPLETO\", \"Ensino Fundamental\", \n    x == \"ENSINO MÉDIO COMPLETO\", \"Ensino Médio\", \n    x == \"ENSINO MÉDIO INCOMPLETO\", \"Ensino Médio\", \n    x == \"SUPERIOR COMPLETO\", \"Ensino Superior\", \n    x == \"SUPERIOR INCOMPLETO\", \"Ensino Superior\", \n    x == \"ANALFABETO\", \"Analfabeto\",\n    x == \"LÊ E ESCREVE\", \"Lê e Escreve\",\n    x == \"16 anos\", \"Jovens\",\n    x == \"17 anos\", \"Jovens\",\n    x == \"18 anos\", \"Jovens\",\n    x == \"19 anos\", \"Jovens\",\n    x == \"20 anos\", \"Adultos\",\n    x == \"21 a 24 anos\", \"Adultos\",\n    x == \"25 a 29 anos\", \"Adultos\",\n    x == \"30 a 34 anos\", \"Adultos\",\n    x == \"35 a 39 anos\", \"Adultos\",\n    x == \"40 a 44 anos\", \"Adultos\",\n    x == \"45 a 49 anos\", \"Adultos\",\n    x == \"50 a 54 anos\", \"Adultos\",\n    x == \"55 a 59 anos\", \"Adultos\",\n    x == \"60 a 64 anos\", \"Idosos I (60 a 74 anos)\",\n    x == \"65 a 69 anos\", \"Idosos I (60 a 74 anos)\",\n    x == \"70 a 74 anos\", \"Idosos I (60 a 74 anos)\",\n    x == \"75 a 79 anos\", \"Idosos II (74 anos+)\",\n    x == \"80 a 84 anos\", \"Idosos II (74 anos+)\",\n    x == \"85 a 89 anos\", \"Idosos II (74 anos+)\",\n    x == \"90 a 94 anos\", \"Idosos II (74 anos+)\",\n    x == \"95 a 99 anos\", \"Idosos II (74 anos+)\",\n    x == \"100 anos ou mais\", \"Idosos II (74 anos+)\",\n    x == \"Inválido\", \"Inválido\",\n    x == \"MASCULINO\", \"Masculino\",\n    x == \"FEMININO\", \"Feminino\",\n    x == \"NÃO INFORMADO\", \"Não Informado\"\n  )\n}\n\ndt_melt[, PERFIL_VALUE := lapply(.SD, recode_perfil), .SDcols = \"PERFIL_VALUE\"]\n\n### Divide dt_melt em três: gênero, idade e escolaridade\ndt_split = data.table:::split.data.table(dt_melt, by = \"PERFIL_VARS\")\n\n### Cria vetores com os estados de cada Região\nnordeste = c(\"MA\", \"PI\", \"CE\", \"RN\", \"PB\", \"PE\", \"AL\", \"SE\", \"BA\")\nnorte = c(\"AM\", \"PA\", \"TO\", \"AC\", \"RO\", \"RR\", \"AP\")\ncentro_oeste = c(\"MT\", \"GO\", \"MS\")\nsudeste = c(\"MG\", \"ES\", \"RJ\", \"SP\")\nsul = c(\"PR\", \"SC\", \"RS\")\n\nregiao_levels = c(\"Norte\", \"Nordeste\", \"Centro-Oeste\", \"Sudeste\", \"Sul\")\n\n### Resume os dados a nível de região\n#### Função para resumir os dados\nmake = function(data, by, vars) {\n  regiao = function(x) {\n    data.table::fcase(\n    x == \"DF\", \"Distrito Federal\",\n    x == \"ZZ\", \"Exterior\",\n    x %in% nordeste, \"Nordeste\",\n    x %in% norte, \"Norte\",\n    x %in% centro_oeste, \"Centro-Oeste\",\n    x %in% sudeste, \"Sudeste\",\n    x %in% sul, \"Sul\"\n    )\n  }\n  data[\n    , REGIAO := lapply(.SD, regiao), .SDcols = \"SG_UF\"][\n      , lapply(.SD, sum), by = eval(by), .SDcols = vars][\n        , tx_abstencao := QT_ABSTENCAO/QT_APTOS * 100, by = eval(by)\n        ][\n          !REGIAO %in% c(\"Exterior\", \"Distrito Federal\")\n        ][\n          , REGIAO := factor(REGIAO, levels = regiao_levels)\n        ][\n          , NR_TURNO := paste0(NR_TURNO, \"º turno\")\n        ]\n}\n\n#### Lista de parâmetros que serão aplicados às tabelas\n##### Variáveis de agrupamento\nby = c(\"REGIAO\", \"NR_TURNO\", \"ANO_ELEICAO\", \"PERFIL_VARS\", \"PERFIL_VALUE\")\n\n##### Variáveis que serão agregadas\nvars = c(\"QT_APTOS\", \"QT_COMPARECIMENTO\", \"QT_ABSTENCAO\")\n\n#### Faz as operações\nparams = list(by = by, vars = vars)\n\ndt_split2 = mapply(\n  make, \n  dt_split,\n  MoreArgs = params,\n  SIMPLIFY = FALSE\n)  \n\n\n\nTaxa de abstenção por Gênero, Escolaridade e Idade\n\nGêneroEscolaridadeIdade\n\n\n\n\nCode\nsysfonts::font_add_google(\"Cutive Mono\")\nfamily = \"Cutive Mono\"\n\n#remotes::install_github(\"arturhgq/ggviz\")\n\ndt_split2$DS_GENERO |> \n  dplyr::filter(\n    PERFIL_VALUE != \"Não Informado\"\n  ) |>\n  ggplot2::ggplot() +\n  ggplot2::facet_wrap(~ NR_TURNO) +\n  ggplot2::aes(\n    y = REGIAO, \n    x = tx_abstencao, \n    fill = PERFIL_VALUE, \n    label = tx_abstencao\n  ) +\n  ggplot2::scale_fill_manual(\n    values = c(\"#4db8ff\", \"#ff9933\")\n  ) +\n  ggplot2::scale_x_continuous(\n    breaks = seq(15, 27, by = 3), \n    limits = c(15,27),\n    expand = c(0,0)\n  ) +\n  ggplot2::geom_point(\n    shape = 22,\n    size = 3\n  ) +\n  ggplot2::labs(\n    title = \"Taxa de abstenção eleitoral por gênero masculino e feminino\",\n    subtitle = \"Em %\",\n    x = \"Taxa de abstenção\",\n    y= \"Região\") +\n  ggviz::theme_academic(\n    size_title = 14,\n    size_axis_text = 12,\n    size_legend = 12,\n    family = family,\n    margin_plot_r = 15,\n    panel.spacing.x = ggplot2::unit(30, \"pt\")\n  ) \n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ndt_split2$DS_GRAU_ESCOLARIDADE |> \n  dplyr::filter(\n    PERFIL_VALUE != \"Não Informado\"\n  ) |>\n  dplyr::mutate(\n    PERFIL_VALUE = forcats::fct_relevel(\n      PERFIL_VALUE,\n      \"Analfabeto\",\n      \"Lê e Escreve\",\n      \"Ensino Fundamental\",\n      \"Ensino Médio\",\n      \"Ensino Superior\"\n    )\n  )  |> \n  ggplot2::ggplot() +\n  ggplot2::facet_wrap(~ NR_TURNO) +\n  ggplot2::aes(\n    y = REGIAO, \n    x = tx_abstencao, \n    fill = PERFIL_VALUE, \n    label = tx_abstencao\n  ) +\n  ggplot2::scale_fill_manual(\n    values = c(\"#990000\", \"#cc3300\", \"#ff9933\", \"#0099cc\", \"#0066cc\")\n  ) +\n  ggplot2::scale_x_continuous(\n    breaks = seq(5, 65, by = 10), \n    limits = c(5,65),\n    expand = c(0,0)\n  ) +\n  ggplot2::geom_point(\n    shape = 22,\n    size = 3\n  ) +\n  ggplot2::labs(\n    title = \"Taxa de abstenção eleitoral por escolaridade\",\n    subtitle = \"Em %\",\n    x = \"Taxa de abstenção\",\n    y= \"Região\",\n    caption = \"As categorias 'Ensino Fundamental', 'Ensino Médio' e 'Ensino Superior'\n    incluem indivíduos que completaram seus estudos ou interromperam-os antes de formar.\") +\n  ggviz::theme_academic(\n    size_title = 14,\n    size_axis_text = 12,\n    size_legend = 12,\n    family = family,\n    margin_plot_r = 10,\n    panel.spacing.x = ggplot2::unit(30, \"pt\")\n  ) +\n  ggplot2::guides(\n    fill = ggplot2::guide_legend(nrow = 2)\n  ) \n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\ndt_split2$DS_FAIXA_ETARIA |> \n  dplyr::filter(\n    !PERFIL_VALUE %in% c(\"Não Informado\", \"Inválido\")\n  ) |>\n  dplyr::mutate(\n    PERFIL_VALUE = forcats::fct_relevel(\n      PERFIL_VALUE,\n      \"Jovens\",\n      \"Adultos\",\n      \"Idosos I (60 a 74 anos)\",\n      \"Idosos II (74 anos+)\"\n    )\n  ) |> \n  ggplot2::ggplot() +\n  ggplot2::facet_wrap(~ NR_TURNO) +\n  ggplot2::aes(\n    y = REGIAO, \n    x = tx_abstencao, \n    fill = PERFIL_VALUE, \n    label = tx_abstencao\n  ) +\n  ggplot2::scale_fill_manual(\n    values = c(\"#4db8ff\", \"#ff9933\", \"#666699\", \"#990000\")\n  ) +\n  ggplot2::scale_x_continuous(\n    breaks = seq(15, 75, by = 10), \n    limits = c(15,75),\n    expand = c(0,0)\n  ) +\n  ggplot2::geom_point(\n    shape = 22,\n    size = 3,\n    alpha = .75\n  ) +\n  ggplot2::labs(\n    title = \"Taxa de abstenção eleitoral por faixas de idade\",\n    subtitle = \"Em %\",\n    x = \"Taxa de abstenção\",\n    y= \"Região\",\n    caption = \"A categoria 'Jovens' inclui indivíduos de 16 a 19 anos. \n    'Adultos', por sua vez, brasileiros de 20 a 59 anos. 'Idosos I', da mesma forma,\n    agregam pessoas com mais de 60 anos e menos que 74 anos. Os demais estão\n    agrupados sob a categoria 'Idosos II'.\") +\n  ggviz::theme_academic(\n    size_title = 14,\n    size_axis_text = 12,\n    size_legend = 12,\n    family = family,\n    margin_plot_r = 10,\n    panel.spacing.x = ggplot2::unit(30, \"pt\")\n  ) +\n  ggplot2::guides(\n    fill = ggplot2::guide_legend(ncol = 3)\n  ) \n\n\n\n\n\n\n\n\n\n\n\n\nResumidos, os dados fornecem ao menos três informações relevantes para a compreensão da dinâmica eleitoral no Brasil. De imediato, em todas as regiões, homens abstiveram-se mais que mulheres, nos dois turnos, especialmente no Centro-Oeste e no Norte.\nEm segundo lugar, o eleitor que não votou nas eleições de 2022 tem pouca ou nenhuma escolaridade. Nesse aspecto, é importante mencionar que o Nordeste apresenta as menores taxas de abstenção em todos os graus de instrução considerados.\nPor fim, vale dizer que a taxa de abstenção por faixas de idade é relativamente homogênea e flutua, entre as regiões, de 17% a 21%. Novamente, destaca-se o Nordeste, região que obteve as menores taxas de abstenção entre a população jovem, nos dois turnos, e entre a população adulta, no primeiro turno. Já no segundo turno, o Sul alcançou a menor taxa de abstenção para o grupo de adultos.\n\n\n\n\n\n\n\nFootnotes\n\n\nVer Antonio Lavareda: ‘Votos válidos derivados das pesquisas são apenas ilações’↩︎"
  },
  {
    "objectID": "posts/elections/20230205-download-tratamento-eleicoes-br.html",
    "href": "posts/elections/20230205-download-tratamento-eleicoes-br.html",
    "title": "Download e tratamento de dados das eleições brasileiras usando R",
    "section": "",
    "text": "Nesta postagem, eu descrevo uma abordagem para download, leitura e tratamento de dados das eleições brasileiras no R, em poucas linhas de código. A atividade é desenvolvida com dados do perfil do eleitorado, detalhes da votação por seção e votação nominal por zona."
  },
  {
    "objectID": "posts/elections/20230205-download-tratamento-eleicoes-br.html#download",
    "href": "posts/elections/20230205-download-tratamento-eleicoes-br.html#download",
    "title": "Download e tratamento de dados das eleições brasileiras usando R",
    "section": "Download",
    "text": "Download\n\nremotes::install_github(\"arturhgq/dtools\")\n\n# Lista de links\nurls = list(\n  eleitorado2022 = paste0(\"https://cdn.tse.jus.br/estatistica/sead/odsele/perfil_eleitorado/perfil_eleitorado_2022.zip\"),\n  votacao_detalhes_secao2022 = paste0(\"https://cdn.tse.jus.br/estatistica/sead/odsele/detalhe_votacao_secao/detalhe_votacao_secao_2022.zip\"),\n  votacao_nominal_zona2022 = paste0(\"https://cdn.tse.jus.br/estatistica/sead/odsele/votacao_candidato_munzona/votacao_candidato_munzona_2022.zip\")\n)\n\n# Download dos arquivos\nfiles = dtools::download.files(urls)"
  },
  {
    "objectID": "posts/elections/20230205-download-tratamento-eleicoes-br.html#leitura",
    "href": "posts/elections/20230205-download-tratamento-eleicoes-br.html#leitura",
    "title": "Download e tratamento de dados das eleições brasileiras usando R",
    "section": "Leitura",
    "text": "Leitura\nDe posse do vetor com o caminho absoluto de cada arquivo, o fragmento de código abaixo é suficiente para ler todas as tabelas de uma vez. Na segunda aba, eu ofereço uma alternativa, com o pacote electionsBR.\n\nR baseelectionsBR\n\n\n\ndata = mapply(\n  dtools::read_delim_zip, \n  x = files, \n  pattern = c(\".csv$\", \"BRASIL.csv$\", \"BRASIL.csv$\"),\n  SIMPLIFY = FALSE\n)\n\n\n\n\nremotes::install_github(\"silvadenisson/electionsBR\")\n\nyear = 2022\n\nvoter_profile = electionsBR::voter_profile(year)\ndetails_mun_zone_fed = electionsBR::details_mun_zone_fed(year, br_archive = TRUE)\nvote_mun_zone_fed = electionsBR::vote_mun_zone_fed(year, br_archive = TRUE)\n\n\n\n\nEm detalhes, mapply aplica à função read_delim_zip dois parâmetros: x e pattern. Em x, atribui-se o caminho absoluto dos três arquivos de interesse - “eleitorado2022”, “votacao_detalhes_secao2022” e “votacao_nominal_zona2022.” Em pattern, define-se, via regex, o padrão de arquivos que deverá ser descompactado e lido para cada x. Quanto mais detalhado for o padrão definido, menores serão os gastos com tempo e com memória RAM.\nVejamos, por exemplo, o arquivo “votacao_nominal_zona2022”. Internamente, ele contém 29 tabelas em .csv e um documento em .pdf. Portanto, caso fosse atribuido a pattern apenas o valor '.csv$', a função read_delim_zip leria e descompactaria 29 tabelas. O padrão 'BRASIL.csv'$, em contraste, seleciona apenas a tabela de interesse, que contém os dados de votacao nominal, a nível de município e zona eleitoral, dos 26 estados, do Distrito Federal e dos eleitores que votaram no exterior.\n\nAbordagem de leitura de dados para redução de gasto de memória RAM\nCertamente, se você não usa um supercomputador, carregar milhares de linhas de dados na memória do seu computador será sempre um desafio. No exemplo acima, eu consumi 9,14 GB1 de memória RAM para carregar 16.818.896 linhas de dados distribuídas em 95 colunas.\nUma opção para tornar viável a leitura de grandes volumes de dados sem estourar a memória RAM de sua máquina é carregar uma tabela de cada vez, tratar os dados da tabela carregada e somente então ler o próximo arquivo, reescrevendo o anterior. Em casos extremos, você pode particionar as tabelas ou selecionar colunas antes de carregá-las. Feito dessa forma, você poupará tempo e memória RAM."
  },
  {
    "objectID": "posts/elections/20230205-download-tratamento-eleicoes-br.html#tratamento-dos-dados",
    "href": "posts/elections/20230205-download-tratamento-eleicoes-br.html#tratamento-dos-dados",
    "title": "Download e tratamento de dados das eleições brasileiras usando R",
    "section": "Tratamento dos dados",
    "text": "Tratamento dos dados\nNesta seção, eu aplico as sugestões que propus no tópico anterior e faço até três operações em cada uma das tabelas: subset, agrupamento e soma. Para reduzir o consumo de tempo das operações, optei pelo pacote data.table ao em vez do amigável dplyr.\n\n## Lista de parâmetros usados nas operações\nparams = list(\n    by_eleitorado2022 = c(\n    \"SG_UF\", \"CD_MUNICIPIO\", \"NM_MUNICIPIO\", \"DS_GENERO\", \"DS_FAIXA_ETARIA\", \n    \"DS_GRAU_ESCOLARIDADE\", \"ANO_ELEICAO\"\n  ),\n  vars_eleitorado2022 = c(\n    \"QT_ELEITORES_PERFIL\", \"QT_ELEITORES_BIOMETRIA\"\n  ),\n  by_detalhes_votacao2022 = c(\n    \"DS_CARGO\", \"NR_TURNO\", \"SG_UF\", \"SG_UE\", \"NM_MUNICIPIO\", \"CD_MUNICIPIO\",\n    \"ANO_ELEICAO\"\n  ),\n  vars_detalhes_votacao2022 = c(\n    \"QT_APTOS\", \"QT_COMPARECIMENTO\",\"QT_ABSTENCOES\", \"QT_VOTOS_BRANCOS\",\n    \"QT_VOTOS_NULOS\", \"QT_VOTOS_NOMINAIS\", \"QT_VOTOS_LEGENDA\"\n  ),\n    by_votacao2022 = c(\n    \"NR_TURNO\", \"SG_UF\", \"NM_MUNICIPIO\", \"CD_MUNICIPIO\", \"NR_CANDIDATO\",\n    \"NM_CANDIDATO\", \"NR_PARTIDO\", \"SG_PARTIDO\", \"NM_PARTIDO\", \"ANO_ELEICAO\"\n  ),\n  vars_votacao2022 = c(\n    \"QT_VOTOS_NOMINAIS\"\n  )\n)\n\n\nPerfil do eleitorado brasileiro (2022)\n\n## Define as variáveis que serão carregadas\nselect = c(params$by_eleitorado2022, params$vars_eleitorado2022)\n\n## Leitura dos dados\ndata = dtools::read_delim_zip(\n  files$eleitorado2022,\n  pattern = \".csv\",\n  col_select = select\n)\n\n## Tratamento dos dados\neleitorado_mun2022 = data.table::setDT(data)[\n    , # seleciona todas as linhas\n    lapply(.SD, sum), # soma todas as colunas contidas em .SD\n    by = eval(params$by_eleitorado2022), # define o agrupamento\n    .SDcols = params$vars_eleitorado2022 # define as colunas de .SD\n  ] \n\n\n\nDetalhes da votação por município e zona eleitoral (2022)\n\n## Define as variáveis que serão carregadas\nselect = c(\n  params$by_detalhes_votacao2022, \n  params$vars_detalhes_votacao2022, \n  \"DS_CARGO\"\n)\n\n## Leitura dos dados\ndata = dtools::read_delim_zip(\n  files$votacao_detalhes_secao2022,\n  pattern = \"BRASIL.csv\",\n  col_select = select\n)\n\n## Tratamento dos dados\nvotacao_detalhes_mun2022 = data.table::setDT(data)[\n    DS_CARGO == \"PRESIDENTE\",\n    lapply(.SD, sum), \n    by = eval(params$by_detalhes_votacao2022),\n    .SDcols = params$vars_detalhes_votacao2022\n  ] \n\n\n\nVotação nominal por município e zona eleitoral\n\n## Define as variáveis que serão carregadas\nselect = c(\n  params$by_votacao2022,\n  params$vars_votacao2022, \n  \"DS_CARGO\"\n)\n\n## Leitura dos dados\ndata = dtools::read_delim_zip(\n  files$votacao_nominal_zona2022,\n  pattern = \"BRASIL.csv\",\n  col_select = select\n)\n\n## Tratamento dos dados\nvotacao_mun2022 = data.table::setDT(data)[\n    DS_CARGO == \"Presidente\",\n    lapply(.SD, sum), \n    by = eval(params$by_votacao2022),\n    .SDcols = params$vars_votacao2022\n  ] \n\n\n\nLimpeza do ambiente global e da memória\nComo resultado da abordagem proposta, o total de memória gasta diminuiu de 9,14 GB para 1,29 GB. Caso precise reduzir ainda mais o consumo de memória, exclua a última tabela carregada no ambiente global e resete a sessão do R. Com essas operações, houve uma nova redução no consumo de memória de 932 mb.\n\nrm(data) # exclui a base original\n.rs.restartR() # reinicia a sessão do R, mas mantém os objetos salvos no \"Global Environment\""
  },
  {
    "objectID": "posts/elections/20230205-download-tratamento-eleicoes-br.html#exportando-os-resultados",
    "href": "posts/elections/20230205-download-tratamento-eleicoes-br.html#exportando-os-resultados",
    "title": "Download e tratamento de dados das eleições brasileiras usando R",
    "section": "Exportando os resultados",
    "text": "Exportando os resultados\n\n## Lista com as tabelas tratadas\ndata = list(\n  eleitorado_mun2022, \n  votacao_detalhes_mun2022, \n  votacao_mun2022\n)\n\n## Nome dos arquivos que serão exportados\nnames = c(\n  \"eleitorado_mun2022.csv\", \n  \"votacao_detalhes_mun2022.csv\",\n  \"votacao_mun2022.csv\"\n)\n\ninvisible(\n  mapply(\n    vroom::vroom_write, \n    x = data, \n    file = here::here(names),\n    delim = \";\",\n    bom = TRUE\n  )\n)"
  },
  {
    "objectID": "posts/stats/stats.html",
    "href": "posts/stats/stats.html",
    "title": "Learning statistics",
    "section": "",
    "text": "No matching items"
  },
  {
    "objectID": "data.html",
    "href": "data.html",
    "title": "Datasets list",
    "section": "",
    "text": "No matching items"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Under construction",
    "section": "",
    "text": "EnglishPortuguês\n\n\nHey there! I am Artur Quirino; I do research and data analysis.\nIn academia, I am interested in an interconnected set of topics, especially political parties, elections, accountability, regime change, methodology and programming. Currently, I am now researching accountability and learning Bayesian statistics as also machine learning. Before, I’ve been researching democratic backsliding in my masters thesis.\nRegarding data analysis, I like to automate processes and usually create functions in R. When I write several functions on the same topic, I make an effort to put them together in a R package, but this is not always the case. One of my 2023 challenges is to do the same thing using Python.\nIn my spare time, I like to exercise daily. Sometimes I play games with my family, sometimes I do Jigsaw Puzzles as well.\n\nEducation\nFederal University of Minas Gerais| Belo Horizonte, Brazil\nMasters in Political Science | 2022\nFederal University of Minas Gerais| Belo Horizonte, Brazil\nB.A in Social Science | 2018\n\n\n\nOi! Me chamo Artur Quirino; sou pesquisador e Cientista de Dados.\nNa academia, me interesso por um conjunto interconectado de tópicos, especialmente partidos políticos, eleiçoes, accountability, mudanças de regime, metodologia e programação. Atualmente, eu estou pesquisando accountability e aprendendo estatística bayesiana e machine learning. Até pouco tempo atrás, eu estive pesquisando retrocesso democrático em minha dissertação de mestrado.\nEm relação a análise de dados, gosto de automatizar processos e costumo criar funções em R. Quando eu escrevo um monte de funções sobre o mesmo tópico, eu me esforço para colocá-las em um pacote estatístico, mas não é sempre o caso. Um de meus desafios para 2023 é também criar pacotes estatísticos usando Python.\nNo meu tempo livre, gosto de me exercitar, diariamente. Às vezes, jogo video games e jogos de tabuleiro com minha família, às vezes, monto quebra-cabeças.\n\nEducação\nUniversidade Federal de Minas Gerais| Belo Horizonte, Brasil\nMestre em Ciência Política | 2022\nUniversidade Federal de Minas Gerais| Belo Horizonte, Brasil\nBacharel em Ciências Sociais | 2018"
  }
]